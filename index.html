<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Build risk calculators for www.riskcalc.org • riskcalc</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Build risk calculators for www.riskcalc.org">
<meta name="description" content="Contains a toolkit for building Shiny-based risk calculators that can be used for individualized risk estimation and decision making. Motivated by the functionality of applications at https://riskcalc.org/.">
<meta property="og:description" content="Contains a toolkit for building Shiny-based risk calculators that can be used for individualized risk estimation and decision making. Motivated by the functionality of applications at https://riskcalc.org/.">
<meta property="og:image" content="https://clevelandclinicqhs.github.io/riskcalc/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">riskcalc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="riskcalc-">riskcalc 
<a class="anchor" aria-label="anchor" href="#riskcalc-"></a>
</h1>
</div>
<!-- badges: start -->

<p>The goal of <code>riskcalc</code> is to provide a toolkit for building <a href="https://www.rstudio.com/products/shiny/" class="external-link"><code>shiny</code></a>-based risk calculators for <a href="https://riskcalc.org/" class="external-link uri">https://riskcalc.org/</a>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>riskcalc</code> from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ClevelandClinicQHS/riskcalc"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h1>
<p>Let’s go through an example of how we can use the <code>risk_calculator</code> function to replicate the functionality of the existing <a href="https://riskcalc.org/bladderCancer/" class="external-link">Bladder Cancer</a> risk calculator on the <a href="https://riskcalc.org" class="external-link uri">https://riskcalc.org</a> website. Currently, it is setup to receive a <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/glm" class="external-link"><code>glm</code></a> or <a href="https://www.rdocumentation.org/packages/survival/versions/3.5-7/topics/coxph" class="external-link"><code>coxph</code></a> object, so we’ll have to build a model first:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://clevelandclinicqhs.github.io/riskcalc/">riskcalc</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build the model</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">Recurrence</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>    data <span class="op">=</span> <span class="va">bladderCancer</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We can just supply the model and a desired prediction time point (since it’s a survival model) to the <code>risk_calculator</code> function, and a <a href=""><code>shiny</code></a> app will be constructed that allows for user input for each predictor in which an individual prediction can be obtained.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/risk_calculator.html">risk_calculator</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/app_default.png"></p>
<p>Now all that is left is formatting to make this application look like the <a href="https://riskcalc.org/bladderCancer/" class="external-link">real one</a>. We can use the plethora of additional arguments to adjust accordingly:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/risk_calculator.html">risk_calculator</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Predicting 5-Year Recurrence-Free Survival after Radical Cystectomy for Bladder Cancer"</span>,</span>
<span>    citation <span class="op">=</span> </span>
<span>      <span class="fu">htmltools</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">p</a></span><span class="op">(</span></span>
<span>        <span class="st">"[1] International Bladder Cancer Nomogram Consortium, Bochner BH, Kattan MW, Vora KC."</span>,</span>
<span>        <span class="fu">htmltools</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">a</a></span><span class="op">(</span></span>
<span>          <span class="st">"Postoperative nomogram predicting risk of recurrence after radical cystectomy for bladder cancer"</span>,</span>
<span>          href <span class="op">=</span> <span class="st">"http://jco.ascopubs.org/content/24/24/3967.full.pdf"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="st">". J Clin Oncol. 2006 Aug 20;24(24):3967-72. Epub 2006 Jul 24. Erratum in: J Clin Oncol. 2007 Apr 10;25(11):1457"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"Percentage of 5-Year Recurrence-Free Survival"</span>,</span>
<span>    value_header <span class="op">=</span> <span class="st">"Probability"</span>,</span>
<span>    format <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">x</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span>,</span>
<span>    app_name <span class="op">=</span> <span class="st">"bladderCancer"</span>,</span>
<span>    labels <span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        Age <span class="op">=</span> <span class="st">"Age (Years)"</span>,</span>
<span>        RCTumorPathology <span class="op">=</span> <span class="st">"RC Tumor Pathology"</span>,</span>
<span>        RCTumorHistology <span class="op">=</span> <span class="st">"RC Tumor Histology"</span>,</span>
<span>        RCTumorGrade <span class="op">=</span> <span class="st">"RC Tumor Grade"</span>,</span>
<span>        LymphNodeStatus <span class="op">=</span> <span class="st">"LymphNodeStatus"</span>,</span>
<span>        DaysBetweenDXRC <span class="op">=</span> <span class="st">"Days Between Dx and RC (Days)"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    levels <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        Gender <span class="op">=</span> </span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            M <span class="op">=</span> <span class="st">"Male"</span>,</span>
<span>            `F` <span class="op">=</span> <span class="st">"Female"</span></span>
<span>          <span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>    placeholders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Age <span class="op">=</span> <span class="st">"20-100"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/app_formatted.png"></p>
<p>Some notes on select arguments:</p>
<ul>
<li>
<code>citation</code>: This is where applications typically display the source publication for the risk calculator. It could just be a simple character string, but in this case, the <a href="https://cran.r-project.org/web/packages/htmltools/index.html" class="external-link"><code>htmltools</code></a> package is used to add text that contains a hyperlink to the publication.</li>
<li>
<code>format</code>: This is a transformation that can be applied to the default result value for preferred display. For a <code>coxph</code> object, by default, the <em>survival</em> probability (which is what we want) is computed at the specified <code>time</code> point (in this case, 5-years), but we added some rounding and tacked on a <code>%</code> symbol. For a <code>glm</code> object, the default output is the predicted value where <code>type = "response"</code> (see <code><a href="https://rdrr.io/r/stats/predict.glm.html" class="external-link">?predict.glm</a></code>)</li>
<li>
<code>app_name</code>: We use short-hand names for applications in their URL at <a href="https://riskcalc.org/" class="external-link">riskcalc.org</a> (e.g., <a href="https://riskcalc.org/bladderCancer/" class="external-link uri">https://riskcalc.org/bladderCancer/</a>). Recently, the source code for applications were <a href="https://github.com/ClevelandClinicQHS/riskcalc-website" class="external-link">added</a> to our <a href="https://github.com/clevelandclinicqhs" class="external-link">QHS GitHub</a> page. Part of that was to add source code links back to GitHub within the apps themselves. So when this argument is used, it will automatically add the source code link to the assumed spot that it would be on GitHub (see bottom-right of screenshot above).</li>
<li>
<code>placeholders</code>: Adds restrictions for what values can be entered into the numeric predictor inputs. It adds the background text so the user can see the range, but it also enforces this restriction with the <a href="https://shiny.posit.co/r/reference/shiny/0.11/validate.html" class="external-link"><code>shiny::validate</code></a> function.</li>
</ul>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing riskcalc</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Cleveland Clinic Quantitative Health Sciences <br><small class="roles"> Copyright holder, funder </small>  </li>
<li>Alex Zajichek <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-9591-6692" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ClevelandClinicQHS/riskcalc/actions/workflows/test-coverage.yaml" class="external-link"><img src="https://github.com/ClevelandClinicQHS/riskcalc/actions/workflows/test-coverage.yaml/badge.svg" alt="test-coverage"></a></li>
<li><a href="https://github.com/ClevelandClinicQHS/riskcalc/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/ClevelandClinicQHS/riskcalc/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://CRAN.R-project.org/package=riskcalc" class="external-link"><img src="https://www.r-pkg.org/badges/version/riskcalc" alt="CRAN status"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cleveland Clinic Quantitative Health Sciences, Alex Zajichek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
